# Vue 源码

## 1

### 1.1 props.调试.[packages/runtime-core/src/component.ts](../../public/example/1.vue3.base/packages/runtime-core/src/component.ts)

```ts
import { reactive } from '@vue/reactivity'
import { initProps } from './componentProps'

export function createInstance(n2) {
  const instance = {
    // 组件的实例，记录组件中属性
    state: null,
    isMounted: false, // 是否挂载成功
    vnode: n2, // 组件的虚拟节点
    subTree: null, // 组件渲染的虚拟节点
    update: null, // 组件更新方法
    propsOptions: n2.type.props, // 用户传递的 props
    props: {},
    attrs: {},
    proxy: null, // 组件的代理对象 proxyRefs
  }
  return instance
}

export function setupComponent(instance) {
  const { type, props } = instance.vnode
  const publicProperties = {
    $attrs: (instance) => instance.attrs,
    $props: (instance) => instance.props,
  }
  instance.proxy = new Proxy(instance, {
    get: (target, key) => {
      const { state, props } = target
      if (key in state) {
        return state[key]
      } else if (key in props) {
        return props[key]
      }
      const getter = publicProperties[key]
      if (getter) {
        return getter(instance) // 传递 instance
      }
    },
    set: (target, key, value) => {
      const { state, props } = target
      if (key in state) {
        state[key] = value
        return true
      } else if (key in props) {
        console.warn(`props[${key as string}] is readonly`)
        return false
      }
      return true
    },
  })
  initProps(instance, props)
  const data = type.data
  if (data) {
    instance.state = reactive(data())
  }
  instance.render = type.render
}
```

### 1.2 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 1.3 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 1.4 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 1.5 [xx](../../public/example/1.vue3.base/xx)

```js

```

## 2

### 2.1 [xx](../../public/example/1.vue3.base/xx)

```ts

```

### 2.2 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 2.3 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 2.4 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 2.5 [xx](../../public/example/1.vue3.base/xx)

```js

```

## 3

### 3.1 [xx](../../public/example/1.vue3.base/xx)

```ts

```

### 3.2 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 3.3 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 3.4 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 3.5 [xx](../../public/example/1.vue3.base/xx)

```js

```

## 4

### 4.1 [xx](../../public/example/1.vue3.base/xx)

```ts

```

### 4.2 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 4.3 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 4.4 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 4.5 [xx](../../public/example/1.vue3.base/xx)

```js

```

## 5

### 5.1 [xx](../../public/example/1.vue3.base/xx)

```ts

```

### 5.2 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 5.3 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 5.4 [xx](../../public/example/1.vue3.base/xx)

```js

```

### 5.5 [xx](../../public/example/1.vue3.base/xx)

```js

```
